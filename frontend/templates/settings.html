{% extends "base.html" %}

{% block title %}Configuración de Notificaciones - Kalendas{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header bg-white">
                <h4 class="mb-0"><i class="bi bi-gear"></i> Preferencias de Notificación</h4>
            </div>
            <div class="card-body">
                <p class="text-muted">Elige cómo quieres enterarte cuando alguien comente en tus eventos.</p>
                
                <form id="settings-form"> 
                    <div class="list-group mb-4">
                        <!-- Opción 1: Email -->
                        <label class="list-group-item d-flex gap-3">
                            <input class="form-check-input flex-shrink-0" type="radio" name="notif_pref" id="notif_email" value="email" checked>
                            <span>
                                <strong>Por Correo Electrónico</strong>
                                <small class="d-block text-muted">Te enviaremos un email instantáneo a tu dirección registrada.</small>
                            </span>
                        </label>
                        
                        <!-- Opción 2: App -->
                        <label class="list-group-item d-flex gap-3">
                            <input class="form-check-input flex-shrink-0" type="radio" name="notif_pref" id="notif_app" value="app">
                            <span>
                                <strong>Al iniciar sesión (En la App)</strong>
                                <small class="d-block text-muted">Verás una alerta en la campana de notificaciones la próxima vez que entres.</small>
                            </span>
                        </label>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="button" class="btn btn-primary" onclick="guardarPreferencias()">
                            Guardar Cambios
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function guardarPreferencias() {
        // Simulación: Guardamos la preferencia en el navegador
        const pref = document.querySelector('input[name="notif_pref"]:checked').value;
        localStorage.setItem('kalendas_notif_pref', pref);
        
        alert('✅ Preferencias guardadas correctamente.\nModo seleccionado: ' + (pref === 'email' ? 'Email' : 'App'));
    }

    // Cargar preferencia guardada al abrir
    document.addEventListener('DOMContentLoaded', () => {
        const saved = localStorage.getItem('kalendas_notif_pref');
        if (saved) {
            const radio = document.querySelector(`input[value="${saved}"]`);
            if(radio) radio.checked = true;
        }
    });
</script>
{% endblock %}